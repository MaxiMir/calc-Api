"use strict";var calcApi,__awaiter=this&&this.__awaiter||function(n,t,e,a){return new(e||(e=Promise))(function(r,i){function o(n){try{c(a.next(n))}catch(n){i(n)}}function s(n){try{c(a.throw(n))}catch(n){i(n)}}function c(n){var t;n.done?r(n.value):(t=n.value,t instanceof e?t:new e(function(n){n(t)})).then(o,s)}c((a=a.apply(n,t||[])).next())})};!function(n){(n=>{(n.calcWidget={}).init=(n=>__awaiter(this,void 0,void 0,function*(){let t,e;const a=null===document||void 0===document?void 0:document.getElementsByClassName("calc-elem"),r=null===document||void 0===document?void 0:document.getElementsByClassName("calc-elem__close"),i=null===document||void 0===document?void 0:document.getElementsByClassName("calc-elem__list"),o=(n,t)=>{n&&n.classList.toggle(t)},s=(n,t)=>{(n instanceof Array?n:[...n]).forEach(n=>{o(n,t)})},c=(n,t=!1,e)=>__awaiter(this,void 0,void 0,function*(){const a={method:t?"POST":"GET",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)};try{const t=yield fetch(n,a);return yield t.json()}catch(n){throw n}}),l=n=>{const e=[...a],r=e.indexOf(n)+1,i=e.slice(0,r),o=e.length===r,s=((n,t)=>{const e={};if(!t||!n)return{modelsParams:e};const a=n.filter(n=>n.checkedID),r=a.reduce((n,t)=>{const{elemBinding:e}=t;return Object.assign(Object.assign({},n),e)},{}),i=a.map(n=>n.table);return{modelsParams:e,data:a,bindingMap:r,excludedModels:i}})(t,o);return i.reduce((n,t)=>{const{table:e,checkedId:a}=t.dataset;return n.modelsParams[e]=a,n},s)},d=n=>__awaiter(this,void 0,void 0,function*(){try{const{isSuccess:e,data:a,msg:r}=yield c("https://slim.xppx.ru/work/src/",!0,n);if(!e)return void u("error",{error:r});t=(n=>(n.length>1&&n.sort((n,t)=>n.sort-t.sort),n))(a),u("show-calc-containers",{containersData:t})}catch(n){u("error")}}),m=n=>{const{elements:t}=n;if(!(1===t.length))return"";const{title:e}=t[0];return`\n                    <div class="calc-container">\n                      <div class="calc-elem calc-price">\n                        <p class="calc-elem__title">Цена:</p>\n                        <p class="calc-elem__title">${e}</p>\n                      </div>\n                    </div>\n                `},b=n=>{const{table:t,title:e,checkedID:a,elements:r}=n;return`\n                  <div class="calc-container">\n                    <div class="calc-elem" \n                        data-table="${t}"\n                        data-checked-id="${a}"\n                    >\n                      <svg\n                          version="1.1"\n                          class="calc-elem__close"\n                          xmlns="http://www.w3.org/2000/svg"\n                          xmlns:xlink="http://www.w3.org/1999/xlink"\n                          x="0px" y="0px"\n                          width="25px"\n                          viewBox="0 0 42 42"\n                          enable-background="new 0 0 42 42"\n                          xml:space="preserve"\n                      >\n                        <path\n                            class="calc-elem__path one"\n                            fill="#cbcbcb"\n                            d="M42,21L42,21c0,1.1-0.9,2-2,2H2c-1.1,0-2-0.9-2-2v0c0-1.1,0.9-2,2-2H40C41.1,19,42,19.9,42,21z" cx="0"\n                            cy="0"\n                        />\n                        <path\n                            class="calc-elem__path two"\n                            fill="#cbcbcb"\n                            d="M21,42L21,42c-1.1,0-2-0.9-2-2V2c0-1.1,0.9-2,2-2h0c1.1,0,2,0.9,2,2V40C23,41.1,22.1,42,21,42z" cx="10"\n                            cy="10"\n                        />\n                      </svg>\n                      <span class="calc-elem__title">${e}</span>\n                      <ul class="calc-elem__list">${((n,t)=>{const e=t?+t:null;return n.map(({id:n,title:t})=>`<li class="${e&&n===e?"calc-elem__link active":"calc-elem__link"}" data-id="${n}">${t}</li>`).join("\n")})(r,a)}</ul>\n                    </div>\n                  </div>\n                `},f=n=>{const t=n.currentTarget;if(!t)return;const e=t.closest(".calc-elem");e?s([e,t],"active"):o(t,"active")},v=n=>{const t=n.currentTarget;if(!t)return;const e=t.closest(".calc-elem");o(e,"hover")},h=n=>__awaiter(this,void 0,void 0,function*(){const t=n.target,e=n.currentTarget;if(!t||!(t!==e))return;const a=t.closest(".calc-elem");if(!a)return;const r=a.querySelector(".calc-elem__link.active"),i=a.querySelector(".calc-elem__title");r&&o(r,"active"),i&&((n,t)=>{n&&(n.innerHTML=t.innerText,o(n,"fade"),setTimeout(()=>{o(n,"fade")},800))})(i,t),((n,t)=>{const{id:e}=t.dataset;n.dataset.checkedId=e})(a,t),s([t,a],"active");const c=l(a);yield d(c)}),u=(n,t={})=>{setTimeout(()=>{if(!e)return;const{error:a,containersData:o}=t;"loader"===n&&(e.innerHTML='\n                    <style>\n                        .calc-loader {\n                            display: none;\n                            margin: 0 auto;\n                        }\n                        .calc-loader.active {\n                            display: block;\n                        }\n                        /* @ LOADER: */\n                        .calc-boxes {\n                            margin: 0 auto;\n                            --size: 32px;\n                            --duration: 800ms;\n                            height: calc(var(--size) * 2);\n                            width: calc(var(--size) * 3);\n                            position: relative;\n                            -webkit-transform-style: preserve-3d;\n                            transform-style: preserve-3d;\n                            -webkit-transform-origin: 50% 50%;\n                            transform-origin: 50% 50%;\n                            -webkit-transform: rotateX(60deg) rotateZ(45deg) rotateY(0deg) translateZ(0px);\n                            transform: rotateX(60deg) rotateZ(45deg) rotateY(0deg) translateZ(0px);\n                        }\n                        .calc-box {\n                            width: var(--size);\n                            height: var(--size);\n                            top: 0;\n                            left: 0;\n                            position: absolute;\n                            -webkit-transform-style: preserve-3d;\n                            transform-style: preserve-3d;\n                        }\n                        .calc-box:nth-child(1) {\n                            -webkit-transform: translate(100%, 0);\n                            transform: translate(100%, 0);\n                            -webkit-animation: box1 var(--duration) linear infinite;\n                            animation: box1 var(--duration) linear infinite;\n                        }\n                        .calc-box:nth-child(2) {\n                            -webkit-transform: translate(0, 100%);\n                            transform: translate(0, 100%);\n                            -webkit-animation: box2 var(--duration) linear infinite;\n                            animation: box2 var(--duration) linear infinite;\n                        }\n                        .calc-box:nth-child(3) {\n                            -webkit-transform: translate(100%, 100%);\n                            transform: translate(100%, 100%);\n                            -webkit-animation: box3 var(--duration) linear infinite;\n                            animation: box3 var(--duration) linear infinite;\n                        }\n                        .calc-box:nth-child(4) {\n                            -webkit-transform: translate(200%, 0);\n                            transform: translate(200%, 0);\n                            -webkit-animation: box4 var(--duration) linear infinite;\n                            animation: box4 var(--duration) linear infinite;\n                        }\n                        .calc-box > div {\n                            --background: #5c8df6;\n                            --top: auto;\n                            --right: auto;\n                            --bottom: auto;\n                            --left: auto;\n                            --translateZ: calc(var(--size) / 2);\n                            --rotateY: 0deg;\n                            --rotateX: 0deg;\n                            position: absolute;\n                            width: 100%;\n                            height: 100%;\n                            background: var(--background);\n                            top: var(--top);\n                            right: var(--right);\n                            bottom: var(--bottom);\n                            left: var(--left);\n                            -webkit-transform: rotateY(var(--rotateY)) rotateX(var(--rotateX)) translateZ(var(--translateZ));\n                            transform: rotateY(var(--rotateY)) rotateX(var(--rotateX)) translateZ(var(--translateZ));\n                        }\n                        .calc-box > div:nth-child(1) {\n                            --top: 0;\n                            --left: 0;\n                        }\n                        .calc-box > div:nth-child(2) {\n                            --background: #145af2;\n                            --right: 0;\n                            --rotateY: 90deg;\n                        }\n                        .calc-box > div:nth-child(3) {\n                            --background: #447cf5;\n                            --rotateX: -90deg;\n                        }\n                        .calc-box > div:nth-child(4) {\n                            --background: #dbe3f4;\n                            --top: 0;\n                            --left: 0;\n                            --translateZ: calc(var(--size) * 3 * -1);\n                        }\n                        @-webkit-keyframes box1 {\n                            0%,\n                            50% {\n                                -webkit-transform: translate(100%, 0);\n                                transform: translate(100%, 0);\n                            }\n                            100% {\n                                -webkit-transform: translate(200%, 0);\n                                transform: translate(200%, 0);\n                            }\n                        }\n                        @keyframes box1 {\n                            0%,\n                            50% {\n                                -webkit-transform: translate(100%, 0);\n                                transform: translate(100%, 0);\n                            }\n                            100% {\n                                -webkit-transform: translate(200%, 0);\n                                transform: translate(200%, 0);\n                            }\n                        }\n                        @-webkit-keyframes box2 {\n                            0% {\n                                -webkit-transform: translate(0, 100%);\n                                transform: translate(0, 100%);\n                            }\n                            50% {\n                                -webkit-transform: translate(0, 0);\n                                transform: translate(0, 0);\n                            }\n                            100% {\n                                -webkit-transform: translate(100%, 0);\n                                transform: translate(100%, 0);\n                            }\n                        }\n                        @keyframes box2 {\n                            0% {\n                                -webkit-transform: translate(0, 100%);\n                                transform: translate(0, 100%);\n                            }\n                            50% {\n                                -webkit-transform: translate(0, 0);\n                                transform: translate(0, 0);\n                            }\n                            100% {\n                                -webkit-transform: translate(100%, 0);\n                                transform: translate(100%, 0);\n                            }\n                        }\n                        @-webkit-keyframes box3 {\n                            0%,\n                            50% {\n                                -webkit-transform: translate(100%, 100%);\n                                transform: translate(100%, 100%);\n                            }\n                            100% {\n                                -webkit-transform: translate(0, 100%);\n                                transform: translate(0, 100%);\n                            }\n                        }\n                        @keyframes box3 {\n                            0%,\n                            50% {\n                                -webkit-transform: translate(100%, 100%);\n                                transform: translate(100%, 100%);\n                            }\n                            100% {\n                                -webkit-transform: translate(0, 100%);\n                                transform: translate(0, 100%);\n                            }\n                        }\n                        @-webkit-keyframes box4 {\n                            0% {\n                                -webkit-transform: translate(200%, 0);\n                                transform: translate(200%, 0);\n                            }\n                            50% {\n                                -webkit-transform: translate(200%, 100%);\n                                transform: translate(200%, 100%);\n                            }\n                            100% {\n                                -webkit-transform: translate(100%, 100%);\n                                transform: translate(100%, 100%);\n                            }\n                        }\n                        @keyframes box4 {\n                            0% {\n                                -webkit-transform: translate(200%, 0);\n                                transform: translate(200%, 0);\n                            }\n                            50% {\n                                -webkit-transform: translate(200%, 100%);\n                                transform: translate(200%, 100%);\n                            }\n                            100% {\n                                -webkit-transform: translate(100%, 100%);\n                                transform: translate(100%, 100%);\n                            }\n                        }\n                    </style>\n                    <div class="calc-loader active" id="calcLoader">\n                        <div class="calc-boxes">\n                            <div class="calc-box">\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                            </div>\n                            <div class="calc-box">\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                            </div>\n                            <div class="calc-box">\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                            </div>\n                            <div class="calc-box">\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                                <div></div>\n                            </div>\n                        </div>\n                    </div>\n                '),"error"===n&&(e.innerHTML=(n=>`\n                  <style>\n                      .calc-error {\n                          color: red;\n                      }\n                  </style>\n                  <p class="calc-error">${n}</p>\n              `)(a||"Что-то пошло не так...")),"show-calc-containers"===n&&o&&(e.innerHTML=(n=>{const t=[];return Object.values(n).forEach(n=>{const{header:e,type:a,elements:r,checkedID:i}=n;n.checkedID=i?+i:null,n.title=((n,t,e)=>e?n.filter(n=>n.id===e)[0].title:t)(r,e,n.checkedID);const o={section:b,price:m}[a](n);t.push(o)}),t.join("\n")})(o),r.length&&[...r].forEach(n=>{n.addEventListener("click",f),n.addEventListener("mouseenter",v),n.addEventListener("mouseover",v)}),i.length&&[...i].forEach(n=>{n.addEventListener("click",h)}))},0)};(()=>{const n=document.createElement("div");n.classList.add("calc-section"),n.insertAdjacentHTML("afterbegin",'\n                    <style>\n                        .calc-section {\n                            width: 100%;\n                            padding: 20px;\n                            font-family: "Helvetica Neue", Arial, serif;\n                        }\n                        .calc-main-container {\n                            display: flex;\n                            flex-wrap: wrap;\n                        }\n                        .calc-container {\n                            min-height: 100px;\n                            margin-bottom: 10px;\n                            padding: 10px;\n                        }\n                        .calc-elem {\n                            color: #636363;\n                            width: 250px;\n                            padding: 10px;\n                            -moz-transition: border 0.3s ease;\n                            -o-transition: border 0.3s ease;\n                            -webkit-transition: border 0.3s ease;\n                            transition: border 0.3s ease;\n                            backface-visibility: hidden;\n                            --borderWidth: 3px;\n                            background: #ffffff;\n                            position: relative;\n                            border-radius: var(--borderWidth);\n                        }\n                        .calc-price {\n                            background: none;\n                        }\n                        .calc-elem:after {\n                            content: \'\';\n                            position: absolute;\n                            top: calc(-1 * var(--borderWidth));\n                            left: calc(-1 * var(--borderWidth));\n                            height: calc(100% + var(--borderWidth) * 2);\n                            width: calc(100% + var(--borderWidth) * 2);\n                            background: linear-gradient(60deg, #f79533, #f37055, #ef4e7b, #a166ab, #5073b8, #1098ad, #07b39b, #6fba82);\n                            border-radius: calc(2 * var(--borderWidth));\n                            z-index: -1;\n                            -webkit-animation: animatedGradient 3s ease alternate infinite;\n                            animation: animatedGradient 3s ease alternate infinite;\n                            background-size: 300% 300%;\n                        }\n                        .calc-elem__title {\n                            font-size: 1rem;\n                            line-height: 32px;\n                            font-weight: bold;\n                            color: #404040bd;\n                            padding: 0 5px;\n                            -moz-transition: color 0.3s ease;\n                            -o-transition: color 0.3s ease;\n                            -webkit-transition: color 0.3s ease;\n                            transition: color 0.3s ease;\n                        }\n                        .calc-price .calc-elem__title {\n                            text-align: center;\n                            color: #fff;\n                        }\n                        .calc-elem__title.fade {\n                            -webkit-animation: colorFade 0.6s 0s ease both;\n                            -moz-animation: colorFade 0.6s 0s ease both;\n                            -ms-animation: colorFade 0.6s 0s ease both;\n                            -o-animation: colorFade 0.6s 0s ease both;\n                            animation: colorFade 0.6s 0s ease both;\n                        }\n                        .calc-elem.active > .calc-elem__list {\n                            display: block;\n                        }\n                        .calc-elem.hover > .calc-elem__title {\n                            color: #b2b2b2;\n                        }\n                        .calc-elem.open .calc-elem__list {\n                            height: 100px;\n                            opacity: 1;\n                        }\n                        .calc-elem__list {\n                            display: none;\n                            list-style-type: none;\n                            font-weight: 200;\n                            width: 100%;\n                            -moz-transition: all 0.3s ease;\n                            -o-transition: all 0.3s ease;\n                            -webkit-transition: all 0.3s ease;\n                            transition: all 0.3s ease;\n                            padding: 10px 5px 0 0;\n                            margin: 15px 0 0;\n                        }\n                        .calc-elem__link {\n                            padding: 5px;\n                            text-decoration: none;\n                            font-size: 1rem;\n                            color: #cbcbcb;\n                            font-weight: bold;\n                            cursor: pointer;\n                            -moz-transition: color 0.3s ease;\n                            -o-transition: color 0.3s ease;\n                            -webkit-transition: color 0.3s ease;\n                            transition: color 0.3s ease;\n                        }\n                        .calc-elem__link:hover {\n                            color: #636363;\n                        }\n                        .calc-elem__link.active {\n                            color: #636363;\n                        }\n                        .calc-elem__list-elem {\n                            padding: 8px 0;\n                        }\n                        .calc-elem__close {\n                            float: right;\n                            fill: #cbcbcb;\n                            position: relative;\n                            top: 4px;\n                            -moz-transform: rotate(0deg);\n                            -ms-transform: rotate(0deg);\n                            -webkit-transform: rotate(0deg);\n                            transform: rotate(0deg);\n                            -moz-transition: all 0.3s ease;\n                            -o-transition: all 0.3s ease;\n                            -webkit-transition: all 0.3s ease;\n                            transition: all 0.3s ease;\n                            cursor: pointer;\n                        }\n                        .calc-elem__path {\n                            -moz-transition: all 0.3s ease;\n                            -o-transition: all 0.3s ease;\n                            -webkit-transition: all 0.3s ease;\n                            transition: all 0.3s ease;\n                        }\n                        .calc-elem__close:hover .calc-elem__path {\n                            fill: #404040;\n                        }\n                        .calc-elem__close.active {\n                            -moz-transform: rotate(-135deg);\n                            -ms-transform: rotate(-135deg);\n                            -webkit-transform: rotate(-135deg);\n                            transform: rotate(-135deg);\n                        }\n                        .calc-elem__close.active .calc-elem__path {\n                            fill: #404040;\n                        }\n                        /* @ ANIMATIONS: */\n                        /* FONT: */\n                        @-moz-keyframes colorFade {\n                            from {\n                                color: #404040;\n                            }\n                            to {\n                                color: #cbcbcb;\n                            }\n                        }\n                        @-webkit-keyframes colorFade {\n                            from {\n                                color: #404040;\n                            }\n                            to {\n                                color: #cbcbcb;\n                            }\n                        }\n                        @keyframes colorFade {\n                            from {\n                                color: #404040;\n                            }\n                            to {\n                                color: #cbcbcb;\n                            }\n                        }\n                        /* BORDER: */\n                        @-webkit-keyframes animatedGradient {\n                            0% {\n                                background-position: 0% 50%;\n                            }\n                            50% {\n                                background-position: 100% 50%;\n                            }\n                            100% {\n                                background-position: 0% 50%;\n                            }\n                        }\n                        @keyframes animatedGradient {\n                            0% {\n                                background-position: 0% 50%;\n                            }\n                            50% {\n                                background-position: 100% 50%;\n                            }\n                            100% {\n                                background-position: 0% 50%;\n                            }\n                        }\n                    </style>\n                    <h2>Калькулятор</h2>\n                    <div id="calcContainer" class="calc-main-container"></div>\n                '),document.body.appendChild(n),e=document.getElementById("calcContainer")})(),u("loader"),yield d({modelsParams:n})}))})(window)}(calcApi||(calcApi={}));